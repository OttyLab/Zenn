---
title: "Mapbox Newsletter WEEKLY TIPSã®è§£èª¬ -ã€Œäººå£å¯†åº¦ã‚’è¦–è¦šåŒ–ã€"
emoji: "ğŸŒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Mapbox", "MapboxGLJS", "GIS", "JavaScript"]
published: false
publication_name: "mapbox_japan"
---

# ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯ã€å…ˆæ—¥é…ä¿¡ã•ã‚ŒãŸMapbox Newsletterã®WEEKLY TIPSã§ç´¹ä»‹ã•ã‚Œã¦ã„ãŸã€Œäººå£å¯†åº¦ã‚’è¦–è¦šåŒ–ã€ã«ã¤ã„ã¦ã®è§£èª¬ã§ã™ã€‚ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã¯Expressionsã«ãŠã‘ã‚‹å¤‰æ•°ã®ä½¿ã„æ–¹ã‚’ä¾‹ç¤ºã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€Newsletterã®è³¼èª­ã¯[ã“ã¡ã‚‰](https://www.mapbox.jp/blog?#:~:text=%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%83%AC%E3%82%BF%E3%83%BC%E3%82%92%E8%B3%BC%E8%AA%AD)ã‹ã‚‰ãŠç”³ã—è¾¼ã¿ã„ãŸã ã‘ã¾ã™ã€‚


ä»¥ä¸‹ãŒæœ¬ã‚µãƒ³ãƒ—ãƒ«ã®ãƒ‡ãƒ¢ã§ã™ã€‚

@[codepen](https://codepen.io/OttyLab/pen/yLwBvrQ)


# ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª

ã¾ãšExamplesã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã«è¡Œãã¾ã—ã‚‡ã†ã€‚

æ—¥æœ¬èªã‚µã‚¤ãƒˆ
@[card](https://docs.mapbox.com/jp/mapbox-gl-js/example/visualize-population-density/)

è‹±èªã‚µã‚¤ãƒˆ
@[card](https://docs.mapbox.com/mapbox-gl-js/example/visualize-population-density/)

åŸºæœ¬çš„ã«åŒã˜ã‚³ãƒ¼ãƒ‰ã§ã™ãŒã€è‹±èªç‰ˆã¯ã‚¹ã‚¿ã‚¤ãƒ«ãŒMapbox Light/Dark v11ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã®ã§ã“ã¡ã‚‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚Mapbox Light/Dark v10ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒWebãƒ¡ãƒ«ã‚«ãƒˆãƒ«ã§ã‚ã‚‹ã®ã«å¯¾ã—ã€Mapbox Light v11ã§ã¯Globeï¼ˆ3Dè¡¨ç¤ºã•ã‚ŒãŸåœ°çƒï¼‰ãªã®ã§ã€å°è±¡ãŒã‹ãªã‚Šç•°ãªã‚Šã¾ã™ã€‚ã¾ãŸã€è‹±èªç‰ˆã¯Mapbox GL JS v3ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

## HTML/CSS

ã¾ãšHTMLã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ä»¥ä¸‹ã¯åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚

```HTML
<div id="map"></div>
```

## Mapã®ä½œæˆ

æ¬¡ã«JavaScriptã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã„ã¤ã‚‚é€šã‚Šã€Mapã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚`container`ã§åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹HTMLã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®idã‚’æŒ‡å®šã—ã¾ã™ã€‚

```JavaScript
const map = new mapboxgl.Map({
  container: 'map', // container ID
  // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
  style: 'mapbox://styles/mapbox/streets-v12', // style URL
  center: [30.0222, -1.9596], // starting position [lng, lat]
  zoom: 7 // starting zoom
});
```

## ã‚½ãƒ¼ã‚¹ã¨ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è¿½åŠ 
ã‚½ãƒ¼ã‚¹ã¨ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã®ã§ã€`map.on('load', ()=> {/*ã“ã“*/})`ã®ä¸­ã«å‡¦ç†ã‚’æ›¸ãã¾ã™ã€‚

ã¾ãšã¯ã‚½ãƒ¼ã‚¹ã§ã™ã€‚Webã‚µãƒ¼ãƒã«ãƒ›ã‚¹ãƒˆã•ã‚ŒãŸGeoJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™ã€‚

```JavaScript
map.addSource('rwanda-provinces', {
  'type': 'geojson',
  'data': 'https://docs.mapbox.com/mapbox-gl-js/assets/rwanda-provinces.geojson'
});
```

GeoJSONã®ä¸­èº«ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¤‡æ•°ã®PolygonãŒ`features`ã®ä¸­ã«å®šç¾©ã•ã‚Œã¦ãŠã‚Šã€å„Polygonã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«`population`ï¼ˆäººå£ï¼‰ã¨`sq-km`ï¼ˆé¢ç©ï¼‰ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ã€‚
![geojson](/images/articles/21df84c1ca391e/geojson.png)

æ¬¡ã¯ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã™ã€‚Polygonãƒ‡ãƒ¼ã‚¿ãªã®ã§`fill`ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€`fill-color`ã§[Expressions](https://docs.mapbox.com/style-spec/reference/expressions/)ã‚’ä½¿ã£ã¦è‰²ã®æŒ‡å®šã‚’ã—ã¦ã„ã¾ã™ã€‚

```JavaScript
map.addLayer(
  {
    'id': 'rwanda-provinces',
    'type': 'fill',
    'source': 'rwanda-provinces',
    'layout': {},
    'paint': {
      'fill-color': [
        // å¾Œè¿°
      ],
      'fill-opacity': 0.7
    }
  },
  'road-label' // Place polygons under labels
);
```

Expressionsã®å†…å®¹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚[`let`](https://docs.mapbox.com/style-spec/reference/expressions/#let)ã¯Expressionså†…ã§å‚ç…§å¯èƒ½ãªå¤‰æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚ã€Œå¤‰æ•°åã€å¤‰æ•°ã«ã„ã‚Œã‚‹å€¤ã€ã®çµ„ã¿åˆã‚ã›ãŒç¶šãã€æœ€å¾Œã®å¼•æ•°ã§å®Ÿéš›ã«å‡ºåŠ›ã•ã‚Œã‚‹Expressionsã‚’è¨˜è¿°ã—ã¾ã™ã€‚ã“ã“ã§ã¯`density`ã¨ã„ã†å¤‰æ•°ã«`['/', ['get', 'population'], ['get', 'sq-km']]`ã§å®šç¾©ã•ã‚Œã‚‹å€¤ã‚’å…¥ã‚Œã¦ã„ã¾ã™ã€‚`['/', ['get', 'population'], ['get', 'sq-km']]`ã¯`poputaion`ã‚’`sq-km`ã§é™¤ç®—ã—ãŸå€¤ã€ã¤ã¾ã‚Šäººå£å¯†åº¦ã§ã™ã€‚

```JavaScript
'fill-color': [
  'let',
  'density',
  ['/', ['get', 'population'], ['get', 'sq-km']],
  // å‡ºåŠ›ã¯å¾Œè¿°
],
```

ä»¥ä¸‹ã¯å‡ºåŠ›éƒ¨åˆ†ã§ã™ã€‚[`interpolate`](https://docs.mapbox.com/style-spec/reference/expressions/#interpolate)ã¯è£œé–“ã§ã™ã€‚ã“ã“ã§ã¯ç·šå½¢è£œé–“(`linear`)ã‚’ä½¿ç”¨ã—ã€`zoom`ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦è‰²ã‚’å¤‰åŒ–ã•ã›ã¾ã™ã€‚

```JavaScript
[
  'interpolate',
  ['linear'],
  ['zoom'],
  8,
  [
    'interpolate',
    ['linear'],
    ['var', 'density'],
    274,
    ['to-color', '#f5e5f3'],
    1551,
    ['to-color', '#8d00ac']
  ],
  10,
  [
    'interpolate',
    ['linear'],
    ['var', 'density'],
    274,
    ['to-color', '#eff3ff'],
    1551,
    ['to-color', '#08519c']
  ]
]
```

ä¸€ã¤å–ã‚Šå‡ºã—ã¦è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚`zoom`ãŒ`8`ã®æ™‚ã€ã•ã‚‰ã«`['var', 'density']`ã®å€¤ã‚’ä½¿ã£ã¦ç·šå½¢è£œé–“ã§è‰²ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚[`var`](https://docs.mapbox.com/style-spec/reference/expressions/#var)ã¯`let`ã§å®šç¾©ã—ãŸå¤‰æ•°ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚ã“ã“ã§ã¯å…ˆç¨‹å®šç¾©ã—ãŸ`density`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚ãã®äººå£å¯†åº¦ãŒ`274`ã®ã¨ãã¯è‰²ã‚’`#f5e5f3`ã€`1551`ã®ã¨ãã¯è‰²ã‚’`#8d00ac`ã¨ã—ã¦ã„ã¾ã™ã€‚

```JavaScript
  8,
  [
    'interpolate',
    ['linear'],
    ['var', 'density'],
    274,
    ['to-color', '#f5e5f3'],
    1551,
    ['to-color', '#8d00ac']
  ],
```

## ã¾ã¨ã‚
å¤‰æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ExpressionsãŒã‚¹ãƒƒã‚­ãƒªã™ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚