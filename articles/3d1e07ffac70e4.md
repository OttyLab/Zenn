---
title: "Mapbox Newsletter WEEKLY TIPSã®è§£èª¬ -ã€Œç”Ÿæˆã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒãƒƒãƒ—ã«è¿½åŠ ã€"
emoji: "ğŸ˜¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Mapbox", "MapboxGLJS", "GIS", "JavaScript"]
published: true
publication_name: "mapbox_japan"
---

# ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯ã€å…ˆæ—¥é…ä¿¡ã•ã‚ŒãŸMapbox Newsletterã®WEEKLY TIPSã§ç´¹ä»‹ã•ã‚Œã¦ã„ãŸã€Œç”Ÿæˆã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒãƒƒãƒ—ã«è¿½åŠ ã€ã«ã¤ã„ã¦ã®è§£èª¬ã§ã™ã€‚ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯[`Map#loadImage`](https://docs.mapbox.com/mapbox-gl-js/api/map/#map#loadimage)ãŠã‚ˆã³[`Map#addImage`](https://docs.mapbox.com/mapbox-gl-js/api/map/#map#addimage)ã®ä½¿ã„æ–¹ã«ã¤ã„ã¦ä¾‹ç¤ºã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€Newsletterã®è³¼èª­ã¯[ã“ã¡ã‚‰](https://www.mapbox.jp/blog?#:~:text=%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%83%AC%E3%82%BF%E3%83%BC%E3%82%92%E8%B3%BC%E8%AA%AD)ã‹ã‚‰ãŠç”³ã—è¾¼ã¿ã„ãŸã ã‘ã¾ã™ã€‚


ä»¥ä¸‹ãŒæœ¬ã‚µãƒ³ãƒ—ãƒ«ã®ãƒ‡ãƒ¢ã§ã™ã€‚
@[codepen](https://codepen.io/OttyLab/pen/GRbjGrE)


# ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª

ã¾ãšExamplesã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã«è¡Œãã¾ã—ã‚‡ã†ã€‚

æ—¥æœ¬èªã‚µã‚¤ãƒˆ
@[card](https://docs.mapbox.com/jp/mapbox-gl-js/example/add-image/)

è‹±èªã‚µã‚¤ãƒˆ
@[card](https://docs.mapbox.com/mapbox-gl-js/example/add-image/)

åŸºæœ¬çš„ã«åŒã˜ã‚³ãƒ¼ãƒ‰ã§ã™ãŒã€è‹±èªç‰ˆã¯ã‚¹ã‚¿ã‚¤ãƒ«ãŒMapbox Dark v11ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã®ã§ã“ã¡ã‚‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚Mapbox Dark v10ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆåœ°å›³æŠ•å½±æ³•ï¼‰ãŒWebãƒ¡ãƒ«ã‚«ãƒˆãƒ«ã§ã‚ã‚‹ã®ã«å¯¾ã—ã€Mapbox Dark v11ã§ã¯Globeï¼ˆ3Dè¡¨ç¤ºã•ã‚ŒãŸåœ°çƒï¼‰ãªã®ã§ã€å°è±¡ãŒã‹ãªã‚Šç•°ãªã‚Šã¾ã™ã€‚ã¾ãŸã€è‹±èªç‰ˆã¯Mapbox GL JS v3ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

## HTML/CSS

ã¾ãšHTMLã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ä»¥ä¸‹ã¯åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã§ã™ã€‚

```HTML
<div id="map"></div>
```

## Mapã®ä½œæˆ

æ¬¡ã«JavaScriptã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã„ã¤ã‚‚é€šã‚Šã€Mapã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚`container`ã§åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹HTMLã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®idã‚’æŒ‡å®šã—ã¾ã™ã€‚

```JavaScript
const map = new mapboxgl.Map({
  container: 'map', // container ID
  // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
  style: 'mapbox://styles/mapbox/dark-v11', // style URL
  zoom: 10, // starting zoom
  center: [-77.432, 25.0306] // starting position
});
```

## loadã‚¤ãƒ™ãƒ³ãƒˆ
ç”»åƒå–å¾—å¾Œã®å¾Œç¶šå‡¦ç†ï¼ˆ`addImage`, `addSource`, `addLayer`ï¼‰ã¯ã‚¹ã‚¿ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿å¾Œã«å®Ÿè¡Œã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã“ã§ã€`load`ã‚¤ãƒ™ãƒ³ãƒˆ(`map.on('load', () => {})`ã®ä¸­èº«)ã§ä»¥é™ã®å‡¦ç†ã‚’è¨˜è¿°ã—ã¦ã„ã¾ã™ã€‚

## ç”»åƒã®å–å¾—
[`Map#loadImage`](https://docs.mapbox.com/mapbox-gl-js/api/map/#map#loadimage)ã‚’ä½¿ã£ã¦ç”»åƒã‚’å–å¾—ã—ã¾ã™ã€‚ç¬¬1å¼•æ•°ãŒç”»åƒã®URLã€ç¬¬2å¼•æ•°ãŒç”»åƒå–å¾—å¾Œã«å‘¼ã°ã‚Œã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§ã™ã€‚ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã®ç¬¬1å¼•æ•°ãŒã‚¨ãƒ©ãƒ¼æƒ…å ±ã€ç¬¬2å¼•æ•°ãŒç”»åƒãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚

```JavaScript
map.loadImage(
  'https://docs.mapbox.com/mapbox-gl-js/assets/cat.png',
  (error, image) => {
...ä¸­ç•¥...
  }
);
```

`fetch`ã‚’ç”¨ã„ã¦ã‚‚åŒæ§˜ã®å‡¦ç†ã¯è¨˜è¿°ã§ãã¾ã™ãŒã€`Map#loadImage`ã¯[ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°](https://github.com/mapbox/mapbox-gl-js/blob/v3.5.2/src/util/ajax.ts#L345-L357)ã‚„[`ImageBitmap`ã¸ã®å¤‰æ›å‡¦ç†](https://github.com/mapbox/mapbox-gl-js/blob/v3.5.2/src/util/ajax.ts#L369)ã‚’è¡Œã£ã¦ãã‚Œã‚‹ã®ã§ä¾¿åˆ©ã§ã™ã€‚

ã¡ãªã¿ã«ã€`fetch`ã‚’ä½¿ã£ãŸå ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå‡¦ç†ã«ãªã‚Šã¾ã™ã€‚

```JavaScript
fetch('https://docs.mapbox.com/mapbox-gl-js/assets/cat.png')
    .then((res) => {
        return res.blob();
    })
    .then(data => {
        return createImageBitmap(data);
    })
    .then(img => {
        // Add the image to the map style.
        map.addImage('cat', img);
...ä»¥ä¸‹ç•¥...
```

## ç”»åƒã®ç™»éŒ²

[`Map#addImage`](https://docs.mapbox.com/mapbox-gl-js/api/map/#map#addimage)ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ç¬¬1å¼•æ•°ãŒidã€ç¬¬2å¼•æ•°ãŒç”»åƒã§ã™ã€‚ã“ã®å‡¦ç†ã‚’è¡Œã†ã“ã¨ã§åˆã‚ã¦GLå†…éƒ¨ã§ç”»åƒãŒä½¿ç”¨ã§ãã¾ã™ã€‚

```JavaScript
map.addImage('cat', image);
```

## ã‚½ãƒ¼ã‚¹ã®ä½œæˆ

ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹ä½ç½®ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã€Pointãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦[GeoJSONã‚½ãƒ¼ã‚¹](https://docs.mapbox.com/style-spec/reference/sources#geojson)ã‚’ä½œæˆã—ã¾ã™ã€‚
```JavaScript
map.addSource('point', {
  'type': 'geojson',
  'data': {
    'type': 'FeatureCollection',
    'features': [
      {
        'type': 'Feature',
        'geometry': {
          'type': 'Point',
          'coordinates': [-77.4144, 25.0759]
        }
      }
    ]
  }
});
```

## ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½œæˆ
[Symbolãƒ¬ã‚¤ãƒ¤ãƒ¼](https://docs.mapbox.com/style-spec/reference/layers#symbol)ã‚’ä½œæˆã—ã€[`icon-image`](https://docs.mapbox.com/style-spec/reference/layers#layout-symbol-icon-image)ã¨ã—ã¦`Map#addImage`ã§å®šç¾©ã—ãŸidã‚’æŒ‡å®šã—ã¾ã™ã€‚

```JavaScript
map.addLayer({
  'id': 'points',
  'type': 'symbol',
  'source': 'point', // reference the data source
  'layout': {
    'icon-image': 'cat', // reference the image
    'icon-size': 0.25
  }
});
```

# ã¾ã¨ã‚
åœ°å›³ä¸Šã«ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã¾ã™ãŒã€ä»Šå›ã¯Symbolãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç”¨ã„ã¦è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã§ã—ãŸã€‚

ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®è¨˜äº‹ã‚‚ã”å‚ç…§ãã ã•ã„ã€‚
https://zenn.dev/ottylab/articles/216cf63e191b31
