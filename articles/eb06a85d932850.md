---
title: "Mapbox Newsletter WEEKLY TIPSã®è§£èª¬ -ã€Œãƒãƒ¼ã‚«ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’æ·»ä»˜ã€"
emoji: "ğŸ“"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Mapbox", "MapboxGLJS", "GIS", "JavaScript"]
published: false
publication_name: "mapbox_japan"
---

# ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯ã€æœ¬æ—¥é…ä¿¡ã•ã‚ŒãŸMapbox Newsletterã®WEEKLY TIPSã§ç´¹ä»‹ã•ã‚Œã¦ã„ãŸã€Œãƒãƒ¼ã‚«ãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’æ·»ä»˜ã€ã«ã¤ã„ã¦ã®è§£èª¬ã§ã™ã€‚ã¾ãŸã€Newsletterã®è³¼èª­ã¯[ã“ã¡ã‚‰](https://www.mapbox.jp/blog?#:~:text=%E3%83%8B%E3%83%A5%E3%83%BC%E3%82%B9%E3%83%AC%E3%82%BF%E3%83%BC%E3%82%92%E8%B3%BC%E8%AA%AD)ã‹ã‚‰ãŠç”³ã—è¾¼ã¿ã„ãŸã ã‘ã¾ã™ã€‚


# ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèª

ã¾ãšExamplesã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã«è¡Œãã¾ã—ã‚‡ã†ã€‚

æ—¥æœ¬èªã‚µã‚¤ãƒˆ
@[card](https://docs.mapbox.com/jp/mapbox-gl-js/example/set-popup/)

è‹±èªã‚µã‚¤ãƒˆ
@[card](https://docs.mapbox.com/mapbox-gl-js/example/set-popup/)

åŸºæœ¬çš„ã«åŒã˜ã‚³ãƒ¼ãƒ‰ã§ã™ãŒã€è‹±èªç‰ˆã¯ã‚¹ã‚¿ã‚¤ãƒ«ãŒMapbox Streets v12ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã®ã§ã“ã¡ã‚‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚Mapbox Streets v11ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒWebãƒ¡ãƒ«ã‚«ãƒˆãƒ«ã§ã‚ã‚‹ã®ã«å¯¾ã—ã€Mapbox Streets v12ã§ã¯Globeï¼ˆ3Dè¡¨ç¤ºã•ã‚ŒãŸåœ°çƒï¼‰ãªã®ã§ã€å°è±¡ãŒã‹ãªã‚Šç•°ãªã‚Šã¾ã™ã€‚


## HTML/CSS

ã¾ãšHTMLã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ä»¥ä¸‹ã¯åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã§ã™ã€‚

```HTML
<div id="map"></div>
```

æ¬¡ã¯CSSã§ã™ã€‚ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯Markerã¨Popupã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ãã‚Œãã‚ŒCSSã‚’è¨­å®šã—ã¾ã™ã€‚ä»¥ä¸‹ã¯Markerã®CSSã§ã™ã€‚[ç”»åƒ](https://docs.mapbox.com/mapbox-gl-js/assets/washington-monument.jpg)ã‚’ä½¿ç”¨ã—ã€è§’ã‚’ä¸¸ã‚ã¦å††å½¢ã«ã—ã¦ã„ã¾ã™ã€‚

```CSS
#marker {
  background-image: url('https://docs.mapbox.com/mapbox-gl-js/assets/washington-monument.jpg');
  background-size: cover;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
}
```

ä»¥ä¸‹ã¯Popupã®CSSã§ã™ã€‚ã“ã®ã‚¯ãƒ©ã‚¹åã¯ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ä¸­ã«ã¯å‡ºã¦ãã¾ã›ã‚“ãŒã€Popupã‚¯ãƒ©ã‚¹å†…éƒ¨ã§ä½¿ç”¨ã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¹åã§ã™ã€‚Popupã‚¯ãƒ©ã‚¹ã¯å†…éƒ¨çš„ã«`div`ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã€ãã‚Œã«å¯¾ã—ã¦`mapboxgl-popup`ã¨ã„ã†ã‚¯ãƒ©ã‚¹åã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚è©³ç´°ã¯[ã“ã¡ã‚‰ã®ã‚³ãƒ¼ãƒ‰](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/popup.js#L466)ã‚’ã”å‚ç…§ãã ã•ã„ã€‚

```CSS
.mapboxgl-popup {
  max-width: 200px;
}
```

## Mapã®ä½œæˆ

æ¬¡ã«JavaScriptã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã„ã¤ã‚‚é€šã‚Šã€Mapã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚`container`ã§åœ°å›³ã‚’è¡¨ç¤ºã™ã‚‹HTMLã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®idã‚’æŒ‡å®šã—ã¾ã™ã€‚

```JavaScript
const map = new mapboxgl.Map({
  container: 'map',
  // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
  style: 'mapbox://styles/mapbox/light-v11',
  center: monument,
  zoom: 15
});
```

Popupã‚’ä½œæˆã—ã¾ã™ã€‚`setText`ã§æ–‡å­—åˆ—ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãã®æ–‡å­—åˆ—ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã‚’ä½œæˆã—ã€`div`ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ã€‚è©³ç´°ã¯[ã“ã¡ã‚‰ã®ã‚³ãƒ¼ãƒ‰](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/popup.js#L628)ã‚’ã”å‚ç…§ãã ã•ã„ã€‚ã¾ãŸã€ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€PopupãŒMarkerã«é‡ãªã‚‰ãªã„ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

```JavaScript
const popup = new mapboxgl.Popup({ offset: 25 }).setText(
  'Construction on the Washington Monument began in 1848.'
);
```

æ¬¡ã«Markerã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯`div`ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã‚’æ˜ç¤ºçš„ã«ä½œæˆã—ã€Markerã¨ã—ã¦ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚idã‚’æŒ‡å®šã—ã¦å…ˆç¨‹ã®CSSã‚’ã‚ã¦ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šæ¨™æº–ã®é’ã„ãƒ”ãƒ³ã§ã¯ãªãã€CSSã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ç”»åƒãŒãƒãƒ¼ã‚«ãƒ¼ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã¾ãŸã€å¾Œã»ã©èª¬æ˜ã—ã¾ã™ãŒ`setPopup`ãƒ¡ã‚½ãƒƒãƒ‰ã§Popupã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨é–¢é€£ä»˜ã‘ã‚‹ã“ã¨ã§ã€Merkerã‚¯ãƒªãƒƒã‚¯æ™‚ã«Popupã‚’è¡¨ç¤ºã™ã‚‹ã¨ã„ã£ãŸé€£æºå‹•ä½œãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

```JavaScript
// create DOM element for the marker
const el = document.createElement('div');
el.id = 'marker';
 
// create the marker
new mapboxgl.Marker(el)
  .setLngLat(monument)
  .setPopup(popup) // sets a popup on this marker
  .addTo(map);
```


# Markerã¨Popupã®é€£æº
Popupã¯Markerã¨é€£æºã™ã‚‹ã“ã¨ã§åˆ©ä¾¿æ€§ãŒå¢—ã—ã¾ã™ã€‚ã“ã“ã§ã¯Markerã®`setPopup`ãƒ¡ã‚½ãƒƒãƒ‰ã¨`addTo`ãƒ¡ã‚½ãƒƒãƒ‰ã®å‡¦ç†å†…å®¹ã‚’ç¢ºèªã—ã€ã©ã®ã‚ˆã†ã«Markerã¨PopupãŒé€£æºã™ã‚‹ã®ã‹ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚

## [`setPopup`](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/marker.js#L323)

### Popupã®offset
ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹ã¨MarkerãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆæ°´è‰²ã®ãƒ”ãƒ³ï¼‰ã®ã¨ãã¯è‡ªå‹•çš„ã«Popupã®offsetãŒè¨­å®šã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã¨ãã¯ã‚¢ã‚¤ã‚³ãƒ³ã®é«˜ã•ãŒæ—¢çŸ¥ãªã®ã§PopupãŒé‡ãªã‚‰ãªã„offsetãŒè¨ˆç®—ã§ãã‚‹ã‹ã‚‰ã§ã™ã­ã€‚ä»Šå›ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ç‹¬è‡ªã®Markerã«å¤‰æ›´ã—ã¦ã„ã‚‹ã®ã§æ˜ç¤ºçš„ã«`offset: 25`ã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚

@[card](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/marker.js#L341-L350)

### Popupã®åº§æ¨™ã®è¨­å®š
ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§Popupã®åº§æ¨™ã‚’è¨­å®šã—ã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã€Popupä½œæˆæ™‚ã«åº§æ¨™ã‚’è¨­å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

@[card](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/marker.js#L354)

## [`addTo`](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/marker.js#L194)

### Popupã®ãƒˆã‚°ãƒ«
Markerã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨è‡ªå‹•çš„ã«PopupãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã«`togglePopup`ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚

@[card](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/marker.js#L386)

[`togglePopup`](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/marker.js#L418)ã®å‡¦ç†ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ã€‚

```JavaScript
const popup = this._popup;
if (!popup) {
    return this;
} else if (popup.isOpen()) {
    popup.remove();
    this._element.setAttribute('aria-expanded', 'false');
} else if (this._map) {
    popup.addTo(this._map);
    this._element.setAttribute('aria-expanded', 'true');
}
```

PopupãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãªã„ã¨ãã¯[`Popup#addTo`](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/popup.js#L141)ã‚’ä½¿ç”¨ã—ã¦Mapã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ç™»éŒ²ã—ã€é€†ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¨ãã¯[`Popup#remove`](https://github.com/mapbox/mapbox-gl-js/blob/v2.15.0/src/ui/popup.js#L215)ã§å‰Šé™¤ã—ã¦ã„ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€è¡¨ç¤ºã™ã‚‹ã¨ãã ã‘Popupã®divã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã—ã€éè¡¨ç¤ºæ™‚ã«ã¯ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆãã®ã‚‚ã®ãŒå‰Šé™¤ã•ã‚Œã‚‹ã®ã§åŠ¹ç‡çš„ã§ã™ã€‚


# ã¾ã¨ã‚

ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ç‹¬è‡ªã®Markerã®è¡¨ç¤ºæ–¹æ³•ã‚„ã€Markerã¨Popupã®é€£æºæ–¹æ³•ã«ã¤ã„ã¦ç¢ºèªã—ã¾ã—ãŸã€‚
