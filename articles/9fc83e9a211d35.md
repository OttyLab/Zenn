---
title: "ãƒ©ã‚¹ã‚¿ãƒ¼MTSãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸ"
emoji: "ğŸ—»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Mapbox", "GIS", "GeoTIFF", "MTS"]
published: false
publication_name: "mapbox_japan"
---

# ã¯ã˜ã‚ã«

ä»¥ä¸‹ã®è¨˜äº‹ã®é€šã‚Šã€å…ˆæ—¥ãƒ©ã‚¹ã‚¿ãƒ¼MTSãŒæ­£å¼ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚
https://www.mapbox.jp/blog/platform-support-for-raster-data-enhances-weather-and-imagery-visualizations

MTSã¯[Mapbox Tiling Service](https://www.mapbox.jp/mts)ã®ç•¥ã§ã€Mapboxã®ã‚µãƒ¼ãƒã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã«å¤‰æ›ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ä»¥å‰ã‹ã‚‰ãƒ™ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã—ãŸãŒã€ä»Šå›ãƒ©ã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã«ã‚‚å¯¾å¿œã—ã€ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã®ä½œæˆãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚

è©³ç´°ã«ã¤ã„ã¦ã¯ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚‚ã”å‚ç…§ãã ã•ã„ã€‚

https://docs.mapbox.com/mapbox-tiling-service/raster/

# MTSã‚’è©¦ã™
ãã‚Œã§ã¯ã€MTSã‚’ç”¨ã„ã¦ãƒ™ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆãŠã‚ˆã³ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯ç°¡å˜ãªè¦³å…‰åœ°å›³ã‚’ä½œã£ã¦ã¿ã¾ã™ã€‚å¯Œå£«å±±è¡Œãã®ãƒã‚¹ãŒç™ºè»Šã™ã‚‹ãƒã‚¹åœã‚’ç¤ºã™ãƒ™ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆãŠã‚ˆã³å¯Œå£«å±±ã®ç”»åƒã‚’è¡¨ç¤ºã™ã‚‹ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

ãªãŠã€MTSã®ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ä½œæˆã™ã‚‹åœ°å›³ã§ã‚ã‚‹ãŸã‚ã€æƒ…å ±ã®æ­£ç¢ºæ€§ã‚’æœŸã™ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

# å‰æº–å‚™
MTSã®APIã‚’å‘¼ã³å‡ºã™ãŸã‚ã«ã¯ç‰¹å®šã®ã‚¹ã‚³ãƒ¼ãƒ—ãŒè¨­å®šã•ã‚ŒãŸã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ãŒå¿…è¦ã§ã™ã€‚ãã“ã§ã€ã‚ã‚‰ã‹ã˜ã‚æº–å‚™ã—ã¾ã™ã€‚

1. https://account.mapbox.com/access-tokens/ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ã€ŒCreate a tokenã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. é©å½“ãªToken nameã‚’å…¥åŠ›
3. Public scopesã®ãƒã‚§ãƒƒã‚¯ã‚’ã™ã¹ã¦å¤–ã™
4. Secret scopesã®TILESETS:LISTã€TILESETS:READã€TILESETS:WRITEã«ãƒã‚§ãƒƒã‚¯
5. ã€ŒCreate tokenã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
6. ä¸€è¦§ç”»é¢ã«è¡¨ç¤ºã•ã‚ŒãŸã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚³ãƒ”ãƒ¼ï¼ˆã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã—ã‹è¡¨ç¤ºã•ã‚Œãªã„ã®ã§ç¢ºå®Ÿã«ã‚³ãƒ”ãƒ¼ï¼‰

ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’å‚è€ƒã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
![token](/images/articles/9fc83e9a211d35/token.png)


# Vector MTS
## ã‚„ã‚‹ã“ã¨
ãƒã‚¹åœã®ä½ç½®ã‚’Pointãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹ãƒ™ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

## ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
MTSã®ãƒ‡ãƒ¼ã‚¿ã«ã¯[line-delimited GeoJSON](https://en.wikipedia.org/wiki/JSON_streaming#Line-delimited_JSON)ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã¯ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‚’ä¸€ã¤ã ã‘å«ã‚€GeoJSONã‚’ä½œæˆã—ã€æ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’å«ã¾ãªã„1è¡Œã®æ–‡å­—åˆ—ã«ã—ãŸã‚‚ã®ã§ã™ã€‚è¤‡æ•°ã®ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‚’è¡¨ç¾ã™ã‚‹ã«ã¯ã€è¤‡æ•°è¡Œè¨˜è¿°ã—ã¾ã™ã€‚å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã‚Šã¾ã™ã€‚

```json:bus.geojson.ld
{"type":"Feature","id":1,"properties":{"name":"JRæ±äº¬é§…ã€€å…«é‡æ´²å—å£"},"geometry":{"coordinates":[139.7681965,35.6796462],"type":"Point"}}
{"type":"Feature","id":1,"properties":{"name":"ãƒã‚¹ã‚¿æ–°å®¿"},"geometry":{"coordinates":[139.7007717,35.6884839],"type":"Point"}}
{"type":"Feature","id":1,"properties":{"name":"ã‚µãƒ³ã‚·ãƒ£ã‚¤ãƒ³ã‚·ãƒ†ã‚£ã€€ãƒ—ãƒªãƒ³ã‚¹ãƒ›ãƒ†ãƒ«"},"geometry":{"coordinates":[139.7197040,35.7298991],"type":"Point"}}
```

## ãƒ¬ã‚·ãƒ”ã®æº–å‚™
[ãƒ¬ã‚·ãƒ”](https://docs.mapbox.com/mapbox-tiling-service/recipe-specification/vector/)ã¯ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ (å¾Œè¿°) ã‚’ã©ã®ã‚ˆã†ã«ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã«å¤‰æ›ã™ã‚‹ã‹ã‚’è¨˜è¿°ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚éå¸¸ã«ç´°ã‹ã„åˆ¶å¾¡ãŒå¯èƒ½ã§ã™ãŒã€ä»Šå›ã¯æœ€ä½é™ã®ä»¥ä¸‹ã®é …ç›®ã‚’è¨­å®šã—ã¾ã™ã€‚

```json:recipe.json
{
  "recipe": {
    "version": 1,
    "layers": {
      "layer0": {
        "source": "mapbox://tileset-source/yochi/bus",
        "minzoom": 0,
        "maxzoom": 18
      }
   }
  },
  "name": "Bus",
  "description": "Bus stops"
}
```

## ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ä½œæˆ
ã“ã“ã‹ã‚‰MTS APIã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã¾ãšã¯[ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹](https://docs.mapbox.com/api/maps/mapbox-tiling-service/#create-a-tileset-source)ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ã¯ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã®å…ƒãƒ‡ãƒ¼ã‚¿ã«ãªã‚‹ã‚‚ã®ã§ã™ã€‚å…ˆç¨‹æº–å‚™ã—ãŸline-delimited GeoJSONã‚’POSTã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

ç’°å¢ƒå¤‰æ•°`$MAPBOX_USERNAME`ã«ã¯ã”è‡ªèº«ã®Mapboxã‚¢ã‚«ã‚¦ãƒ³ãƒˆåã€`$SECRET_MAPBOX_ACCESS_TOKEN`ã«ã¯å…ˆã»ã©ä½œæˆã—ãŸã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä»£å…¥ã—ã¦ãã ã•ã„ã€‚

```shell-session
% TILESOURCE_ID=bus
% curl -X POST "https://api.mapbox.com/tilesets/v1/sources/$MAPBOX_USERNAME/$TILESOURCE_ID?access_token=$SECRET_MAPBOX_ACCESS_TOKEN" \
    -F file=@./bus.geojson.ld \
    --header "Content-Type: multipart/form-data"
{"id":"mapbox://tileset-source/yochi/bus","files":1,"source_size":449,"file_size":449}%
```

## ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ä¸€è¦§
ä½œæˆæ¸ˆã¿ã®[ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ã‚’å–å¾—ã™ã‚‹](https://docs.mapbox.com/api/maps/mapbox-tiling-service/#list-tileset-sources)ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ã¯[Studio](https://studio.mapbox.com/)ã®Datasetsã¨ã¯ç•°ãªã‚‹æ¦‚å¿µã§ã™ã€‚ãã®ãŸã‚ã€Studioã§ã¯ç¢ºèªã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

```shell-session
% curl "https://api.mapbox.com/tilesets/v1/sources/$MAPBOX_USERNAME?access_token=$SECRET_MAPBOX_ACCESS_TOKEN"
[{"id":"mapbox://tileset-source/yochi/bus","size":449,"files":1}]
```

## ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆä½œæˆ
æ¬¡ã«[ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆä½œæˆ](https://docs.mapbox.com/api/maps/mapbox-tiling-service/#create-a-tileset)ã‚’è¡Œã„ã¾ã™ã€‚ã“ã“ã§ä½œæˆã™ã‚‹ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã®IDã¨å…ˆã»ã©ä½œæˆã—ãŸãƒ¬ã‚·ãƒ”ã‚’æŒ‡å®šã—ã¾ã™ã€‚ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆIDã¯`ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå.ä»»æ„ã®ID`ã¨ã„ã†å½¢å¼ãŒå¿…è¦ã§ã™ã€‚

```shell-session
TILESET_ID=yochi.bus
curl -X POST "https://api.mapbox.com/tilesets/v1/$TILESET_ID?access_token=$SECRET_MAPBOX_ACCESS_TOKEN" \
  -d @recipe.json \
  --header "Content-Type:application/json"
{"message":"Successfully created empty tileset yochi.bus. Publish your tileset to begin processing your data into tiles."}
```

ã“ã®æ®µéšã§Studioä¸Šã§ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãŸã ã—ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã¾ã ä½¿ç”¨ã§ãã‚‹çŠ¶æ…‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

![before_publish](/images/articles/9fc83e9a211d35/before_publish.png)

## ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥
[ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥](https://docs.mapbox.com/api/maps/mapbox-tiling-service/#publish-a-tileset)ã™ã‚‹ã“ã¨ã§ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã¸ã®å¤‰æ›å‡¦ç†ãŒé–‹å§‹ã•ã‚Œã€ä½¿ç”¨ã§ãã‚‹çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚

```shell-session
% curl -X POST "https://api.mapbox.com/tilesets/v1/$TILESET_ID/publish?access_token=$SECRET_MAPBOX_ACCESS_TOKEN"
{"message":"Processing yochi.bus","jobId":"clzo5lzww000c08mm2efp6f0n"}%
```

## é€²æ—ç¢ºèª
å¤‰æ›å‡¦ç†ã«ã¯æ•°åˆ†ç¨‹åº¦æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥æ™‚ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å«ã¾ã‚Œã¦ã„ãŸ`jobId`ã‚’ç”¨ã„ã¦ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§é€²æ—ãŒç¢ºèªã§ãã¾ã™ã€‚å¤‰æ›ä¸­ã¯`"stage":"processing"`ã¨ãªã‚Šã¾ã™ã€‚

```shell-session
% JOB_ID=clzo5lzww000c08mm2efp6f0n
% curl "https://api.mapbox.com/tilesets/v1/$TILESET_ID/jobs/$JOB_ID?access_token=$SECRET_MAPBOX_ACCESS_TOKEN"
{"id":"clzo5lzww000c08mm2efp6f0n","stage":"processing","tilesetId":"yochi.bus","errors":[],"completed":null,"created":1723295440400,"created_nice":"Sat Aug 10 2024 13:10:40 GMT+0000 (Coordinated Universal Time)","published":1723295440400,"warnings":[],"filesize":449,"recipe":{"version":1,"layers":{"layer0":{"source":"mapbox://tileset-source/yochi/bus","minzoom":0,"maxzoom":18}}}}%
```

å¤‰æ›ãŒçµ‚äº†ã™ã‚‹ã¨`"stage":"success"`ã¨ãªã‚Šã¾ã™ã€‚
```shell-session
% curl "https://api.mapbox.com/tilesets/v1/$TILESET_ID/jobs/$JOB_ID?access_token=$SECRET_MAPBOX_ACCESS_TOKEN"
{"id":"clzo5lzww000c08mm2efp6f0n","stage":"success","tilesetId":"yochi.bus","errors":[],"completed":1723295543506,"created":1723295440400,"created_nice":"Sat Aug 10 2024 13:10:40 GMT+0000 (Coordinated Universal Time)","published":1723295440400,"warnings":[],"layer_stats":{ä»¥ä¸‹ç•¥
```

## å®Œæˆ
Studioä¸Šã§ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆãŒç¢ºèªã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
![published](/images/articles/9fc83e9a211d35/published.png)

# Raster MTS
## ã‚„ã‚‹ã“ã¨
å¯Œå£«å±±ã®ç”»åƒã‚’å¯Œå£«å±±ã®ã‚ãŸã‚Šã«è¡¨ç¤ºã™ã‚‹ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ©ã‚¹ã‚¿ãƒ¼MTSã¯ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦[GeoTIFFã‚’ã‚µãƒãƒ¼ãƒˆ](https://docs.mapbox.com/mapbox-tiling-service/raster/supported-file-formats/)ã—ã¦ã„ã‚‹ã®ã§ã€ã¾ãšã¯ãã‚Œã‚’æº–å‚™ã—ã¾ã™ã€‚

## GeoTIFFã‚’æº–å‚™ã™ã‚‹
GeoTIFFã¯åº§æ¨™æƒ…å ±ãŒåŸ‹ã‚è¾¼ã¾ã‚ŒãŸTIFFç”»åƒã§ã™ã€‚GeoTIFFã¯[QGIS](https://www.qgis.org/)ã‚’ä½¿ã£ã¦ä½œæˆã§ãã¾ã™ã€‚

### ç”»åƒã®æº–å‚™
ã„ã‚‰ã™ã¨ã‚„ã§ã„ã„æ„Ÿã˜ã®å¯Œå£«å±±ã®ç”»åƒã‚’è¦‹ã¤ã‘ãŸã®ã§ã“ã‚Œã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚
https://www.irasutoya.com/2023/10/2024_0821222460.html

### QGIS
1. ã€ŒBrowserã€â†’ã€ŒXYZ Tilesã€â†’ã€ŒOpenStreatMapã€ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã€OSMã‚’è¡¨ç¤º
![map](/images/articles/9fc83e9a211d35/map.png =300x)
2. ã€ŒLayerã€â†’ã€ŒGeoreferencer...ã€ã‚’é¸æŠ
![georeference](/images/articles/9fc83e9a211d35/georeference.png =300x)
3. é–‹ã„ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€ŒOpen Raster...ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã‚’é¸æŠ
![open raster](/images/articles/9fc83e9a211d35/open_raster.png =300x)
4. ç”»åƒã®èª­ã¿è¾¼ã¿å®Œäº†
![opened](/images/articles/9fc83e9a211d35/opened.png)
5. ç”»åƒä¸Šã®ç‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€é–‹ã„ãŸã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ã®ã€ŒFrom Map Canvasã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
![input1](/images/articles/9fc83e9a211d35/input1.png)
6. åœ°å›³ä¸Šã®ç‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚ã“ã‚Œã«ã‚ˆã‚Š4.ã®ç”»åƒä¸Šã®ç‚¹ã¨åœ°å›³ä¸Šã®åº§æ¨™ãŒé–¢é€£ä»˜ã‘
![input2](/images/articles/9fc83e9a211d35/input2.png)
7. 4éš…ã®åº§æ¨™ã‚’å…¥åŠ›
![done](/images/articles/9fc83e9a211d35/done.png)
8. ã€ŒStart Georeferencingã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€å‡ºåŠ›ã€‚ãƒ•ã‚¡ã‚¤ãƒ«åã®å…¥åŠ›ã‚’è¦æ±‚ã•ã‚ŒãŸå ´åˆã¯ã€å…¥åŠ›å¾Œå†åº¦ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
![export](/images/articles/9fc83e9a211d35/export.png =300x)

## ãƒ¬ã‚·ãƒ”ã®æº–å‚™
[ãƒ©ã‚¹ã‚¿ãƒ¼ç”¨ã®ãƒ¬ã‚·ãƒ”](https://docs.mapbox.com/mapbox-tiling-service/recipe-specification/raster/)ã‚’ä½œæˆã—ã¾ã™ã€‚æœ¬æ¥ã€ãƒ©ã‚¹ã‚¿ãƒ¼MTSã§ã¯`tilesize`ã€`buffer`ã¯ä¸è¦ã§ã™ãŒã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å´ã®å½±éŸ¿ã§æŒ‡å®šã—ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹çŠ¶æ³ã§ã™ã€‚æ”¹å–„æ¬¡ç¬¬ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã™ã€‚

```json:recipe_fuji.json
{
  "recipe": {
    "type": "raster",
    "version": 1,
    "sources": [
      {
        "uri": "mapbox://tileset-source/yochi/fuji"
      }
    ],
    "minzoom": 0,
    "maxzoom": 16,
    "layers": {
      "fuji": {
        "tilesize": 512,
        "buffer": 1
      }
    }
  },
  "name": "Mt.Fuji",
  "description": "Mt.Fuji image"
}
```

## ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ä½œæˆ
ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ã®ä½œæˆæ–¹æ³•ã¯ãƒ™ã‚¯ã‚¿ãƒ¼MTSã¨åŒã˜ã§ã™ã€‚

```shell-session
% TILESOURCE_ID=fuji
% curl -X POST "https://api.mapbox.com/tilesets/v1/sources/$MAPBOX_USERNAME/$TILESOURCE_ID?access_token=$SECRET_MAPBOX_ACCESS_TOKEN" \
    -F file=@fuji.tiff \
    --header "Content-Type: multipart/form-data"
{"id":"mapbox://tileset-source/yochi/fuji","files":1,"source_size":1533817,"file_size":1533817}
```

## ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ä¸€è¦§
ã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ã®ä¸€è¦§å–å¾—æ–¹æ³•ã‚‚ãƒ™ã‚¯ã‚¿ãƒ¼MTSã¨åŒã˜ã§ã™ã€‚ä»Šä½œæˆã—ãŸ`fuji`ãŠã‚ˆã³å…ˆã»ã©ä½œæˆã—ãŸ`bus`ã®ä¸¡æ–¹ãŒè¦‹ãˆã¦ã„ã¾ã™ã€‚

```shell-session
curl "https://api.mapbox.com/tilesets/v1/sources/$MAPBOX_USERNAME?access_token=$SECRET_MAPBOX_ACCESS_TOKEN"
[{"id":"mapbox://tileset-source/yochi/fuji","size":1533817,"files":1},{"id":"mapbox://tileset-source/yochi/bus","size":449,"files":1}]
```

## ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆä½œæˆ
ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã®ä½œæˆæ–¹æ³•ã‚‚ãƒ™ã‚¯ã‚¿ãƒ¼MTSã¨åŒã˜ã§ã™ã€‚

```shell-session
% TILESET_ID=yochi.fuji
% curl -X POST "https://api.mapbox.com/tilesets/v1/$TILESET_ID?access_token=$SECRET_MAPBOX_ACCESS_TOKEN" \
  -d @recipe_fuji.json \
  --header "Content-Type:application/json"
{"message":"Successfully created empty tileset yochi.fuji. Publish your tileset to begin processing your data into tiles."}
```

## ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥
ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ¥æ–¹æ³•ã‚‚ãƒ™ã‚¯ã‚¿ãƒ¼MTSã¨åŒã˜ã§ã™ã€‚

```shell-session
% curl -X POST "https://api.mapbox.com/tilesets/v1/$TILESET_ID/publish?access_token=$SECRET_MAPBOX_ACCESS_TOKEN"
{"message":"Processing yochi.fuji","jobId":"clzoci774000z08l51zm1hu8u"}
```

## å®Œæˆ
Studioä¸Šã§ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆãŒç¢ºèªã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
![published_fuji](/images/articles/9fc83e9a211d35/published_fuji.png)


# ä½¿ã£ã¦ã¿ã‚‹
ä½œæˆã—ãŸã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã¯ã‚¹ã‚¿ã‚¤ãƒ«ã®ä¸­ã§åˆ©ç”¨ã§ãã¾ã™ã€‚Studioã§ç·¨é›†ã€ã‚³ãƒ¼ãƒ‰ä¸Šã§ç›´æ¥ã‚½ãƒ¼ã‚¹ãƒ»ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½œæˆã®ã©ã¡ã‚‰ã§ã‚‚OKã§ã™ã€‚ã“ã“ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã§è©¦ã—ã¾ã—ãŸã€‚

```JavaScript
map.on('load', () => {
    map.addSource('bus', {
        type: 'vector',
        url: 'mapbox://yochi.bus',
    });
    map.addLayer({
        id: 'bus',
        type: 'symbol',
        source: 'bus',
        'source-layer': 'layer0',
        layout: {
            'text-field': ['get', 'name'],
            'text-anchor': 'bottom',
            'icon-image': 'parking',
            'icon-size': 2,
        }
    });

    map.addSource('fuji', {
        type: 'raster',
        url: 'mapbox://yochi.fuji',
    });
    map.addLayer({
        id: 'fuji',
        type: 'raster',
        source: 'fuji',
    });
});
```

å®Ÿè¡Œçµæœã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
@[codepen](https://codepen.io/OttyLab/pen/NWZagKq)


# ã¾ã¨ã‚
ãƒ©ã‚¹ã‚¿ãƒ¼MTSã¯ãƒ™ã‚¯ã‚¿ãƒ¼MTSã¨åŒã˜ãƒ•ãƒ­ãƒ¼ã§åˆ©ç”¨ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
